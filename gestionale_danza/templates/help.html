{% extends "base.html" %}

{% block title %}Guida all'uso - Dance2Manager{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-md-3">
            <!-- Sidebar Navigation -->
            <div class="card sticky-top" style="top: 20px;">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0"><i class="bi bi-book me-2"></i>Indice</h5>
                </div>
                <div class="card-body p-0">
                    <div class="list-group list-group-flush">
                        <a href="#introduzione" class="list-group-item list-group-item-action">
                            <i class="bi bi-info-circle me-2"></i>Introduzione
                        </a>
                        <a href="#primo-accesso" class="list-group-item list-group-item-action">
                            <i class="bi bi-play-circle me-2"></i>Primo Accesso & 2FA
                        </a>
                        <a href="#password-recovery" class="list-group-item list-group-item-action">
                            <i class="bi bi-key me-2"></i>Recupero Password
                        </a>
                        <a href="#clienti" class="list-group-item list-group-item-action">
                            <i class="bi bi-people me-2"></i>Gestione Clienti
                        </a>
                        <a href="#insegnanti" class="list-group-item list-group-item-action">
                            <i class="bi bi-person-badge me-2"></i>Gestione Insegnanti
                        </a>
                        <a href="#corsi" class="list-group-item list-group-item-action">
                            <i class="bi bi-calendar-week me-2"></i>Gestione Corsi
                        </a>
                        <a href="#pagamenti" class="list-group-item list-group-item-action">
                            <i class="bi bi-credit-card me-2"></i>Gestione Pagamenti
                        </a>
                        <a href="#report" class="list-group-item list-group-item-action">
                            <i class="bi bi-graph-up me-2"></i>Report e Email
                        </a>
                        <a href="#impostazioni" class="list-group-item list-group-item-action">
                            <i class="bi bi-gear me-2"></i>Impostazioni & Logo
                        </a>
                        <a href="#email-config" class="list-group-item list-group-item-action">
                            <i class="bi bi-envelope-gear me-2"></i>Configurazione Email
                        </a>
                        <a href="#backup" class="list-group-item list-group-item-action">
                            <i class="bi bi-shield-check me-2"></i>Backup & Sicurezza
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-9">
            <!-- Header -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1><i class="bi bi-question-circle me-2"></i>Guida all'uso di Dance2Manager</h1>
                <button onclick="window.print()" class="btn btn-outline-primary">
                    <i class="bi bi-printer me-1"></i>Stampa Guida
                </button>
            </div>

            <!-- Introduzione -->
            <section id="introduzione" class="mb-5">
                <div class="card">
                    <div class="card-header bg-info text-white">
                        <h3 class="mb-0"><i class="bi bi-info-circle me-2"></i>Introduzione</h3>
                    </div>
                    <div class="card-body">
                        <p class="lead">Dance2Manager √® un software gestionale completo e moderno per scuole di danza con funzionalit√† avanzate di comunicazione e sicurezza.</p>
                        
                        <h5>‚ú® Nuove Funzionalit√† 2024:</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <ul class="list-unstyled">
                                    <li><i class="bi bi-check-circle text-success me-2"></i><strong>Autenticazione a Due Fattori (2FA)</strong></li>
                                    <li><i class="bi bi-check-circle text-success me-2"></i><strong>Recupero Password via Email</strong></li>
                                    <li><i class="bi bi-check-circle text-success me-2"></i><strong>Email Report agli Insegnanti</strong></li>
                                    <li><i class="bi bi-check-circle text-success me-2"></i><strong>Logo Aziendale Personalizzato</strong></li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul class="list-unstyled">
                                    <li><i class="bi bi-check-circle text-success me-2"></i><strong>Sistema Email SMTP Integrato</strong></li>
                                    <li><i class="bi bi-check-circle text-success me-2"></i><strong>Notifiche SweetAlert Eleganti</strong></li>
                                    <li><i class="bi bi-check-circle text-success me-2"></i><strong>Report HTML con Allievi</strong></li>
                                    <li><i class="bi bi-check-circle text-success me-2"></i><strong>UI Moderna e Responsive</strong></li>
                                </ul>
                            </div>
                        </div>

                        <h5 class="mt-4">Funzionalit√† di Base:</h5>
                        <div class="row">
                            <div class="col-md-6">
                                <ul class="list-unstyled">
                                    <li><i class="bi bi-check-circle text-success me-2"></i>Gestione completa clienti</li>
                                    <li><i class="bi bi-check-circle text-success me-2"></i>Organizzazione corsi e orari</li>
                                    <li><i class="bi bi-check-circle text-success me-2"></i>Tracciamento pagamenti</li>
                                    <li><i class="bi bi-check-circle text-success me-2"></i>Ricevute PDF automatiche</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <ul class="list-unstyled">
                                    <li><i class="bi bi-check-circle text-success me-2"></i>Calcolo compensi insegnanti</li>
                                    <li><i class="bi bi-check-circle text-success me-2"></i>Report finanziari dettagliati</li>
                                    <li><i class="bi bi-check-circle text-success me-2"></i>Gestione dati aziendali</li>
                                    <li><i class="bi bi-check-circle text-success me-2"></i>Software portatile (no installazione)</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="alert alert-warning mt-3">
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            <strong>Primo Accesso:</strong> Username: <code>admin</code>, Password: <code>admin123</code>
                            <br><small class="text-muted">‚ö†Ô∏è Cambiare immediatamente la password predefinita per sicurezza!</small>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Primo Accesso & 2FA -->
            <section id="primo-accesso" class="mb-5">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h3 class="mb-0"><i class="bi bi-shield-lock me-2"></i>Primo Accesso & Sicurezza 2FA</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>üîê Autenticazione a Due Fattori (2FA)</h5>
                                <p>Il sistema offre sicurezza avanzata con autenticazione a due fattori:</p>
                                <ol>
                                    <li><strong>Login Standard:</strong> Username e password</li>
                                    <li><strong>Codice 2FA via Email:</strong> Inserire il codice di 6 cifre ricevuto via email</li>
                                    <li><strong>App Authenticator:</strong> Opzionale, scansiona QR code per Google Authenticator</li>
                                </ol>

                                <div class="alert alert-info">
                                    <h6><i class="bi bi-info-circle me-2"></i>Configurazione 2FA</h6>
                                    <ul class="mb-0">
                                        <li><strong>Menu Utente</strong> ‚Üí <strong>Configurazione 2FA</strong></li>
                                        <li>Scegli tra Email o App Authenticator</li>
                                        <li>Il 2FA √® <strong>opzionale</strong> ma raccomandato</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>1. Configurazione Iniziale</h5>
                                <ol>
                                    <li><strong>Menu utente ‚Üí Impostazioni Azienda</strong></li>
                                    <li>Inserire denominazione sociale</li>
                                    <li>Caricare logo aziendale (opzionale)</li>
                                    <li>Compilare indirizzo e contatti</li>
                                    <li>Configurare email SMTP per 2FA</li>
                                </ol>

                                <h5 class="mt-4">2. Dati di Prova</h5>
                                <p>Per testare il sistema:</p>
                                <div class="bg-light p-3 rounded">
                                    <code>python seeder.py</code>
                                </div>
                                <small class="text-muted">Crea 4 insegnanti, 6 corsi, 10 clienti e 28 pagamenti</small>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Recupero Password -->
            <section id="password-recovery" class="mb-5">
                <div class="card">
                    <div class="card-header bg-warning text-dark">
                        <h3 class="mb-0"><i class="bi bi-key me-2"></i>Recupero Password</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>üîë Password Dimenticata?</h5>
                                <ol>
                                    <li>Nella pagina di login, cliccare <strong>"Password dimenticata?"</strong></li>
                                    <li>Inserire il proprio indirizzo email</li>
                                    <li>Controllare la casella email (anche spam)</li>
                                    <li>Cliccare sul link di reset ricevuto</li>
                                    <li>Impostare nuova password sicura</li>
                                </ol>

                                <div class="alert alert-success">
                                    <h6><i class="bi bi-shield-check me-2"></i>Sicurezza</h6>
                                    <ul class="mb-0">
                                        <li>Link valido per <strong>24 ore</strong></li>
                                        <li>Validazione forza password in tempo reale</li>
                                        <li>Conferma password obbligatoria</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>üí° Suggerimenti Password Sicura</h5>
                                <ul>
                                    <li><strong>Almeno 8 caratteri</strong></li>
                                    <li><strong>Lettere maiuscole e minuscole</strong></li>
                                    <li><strong>Numeri</strong></li>
                                    <li><strong>Caratteri speciali</strong> (!@#$%^&*)</li>
                                </ul>

                                <div class="bg-light p-3 rounded mt-3">
                                    <small class="text-muted">
                                        <i class="bi bi-lightbulb me-1"></i>
                                        Il sistema mostra un indicatore di forza password in tempo reale
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Gestione Clienti -->
            <section id="clienti" class="mb-5">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h3 class="mb-0"><i class="bi bi-people me-2"></i>Gestione Clienti</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Aggiungere Cliente</h5>
                                <ol>
                                    <li><strong>Clienti</strong> ‚Üí <strong>Nuovo Cliente</strong></li>
                                    <li>Compilare dati anagrafici</li>
                                    <li><strong>Importante:</strong> Codice Fiscale (per ricevute)</li>
                                    <li>Inserire contatti (email per comunicazioni)</li>
                                </ol>
                                
                                <h5 class="mt-4">Iscrizione a Corso</h5>
                                <ol>
                                    <li>Aprire scheda cliente</li>
                                    <li>Sezione <strong>Iscrizioni</strong></li>
                                    <li><strong>Iscriviti a Corso</strong></li>
                                    <li>Sistema crea pagamenti automaticamente</li>
                                </ol>
                            </div>
                            <div class="col-md-6">
                                <div class="alert alert-info">
                                    <h6><i class="bi bi-lightbulb me-2"></i>Suggerimenti</h6>
                                    <ul class="mb-0">
                                        <li>Codice Fiscale importante per ricevute fiscali</li>
                                        <li>Email <strong>essenziale</strong> per report automatici</li>
                                        <li>Telefono per contatti urgenti</li>
                                        <li>Data nascita per statistiche et√†</li>
                                    </ul>
                                </div>
                                
                                <div class="alert alert-warning">
                                    <i class="bi bi-exclamation-triangle me-2"></i>
                                    <strong>Attenzione:</strong> Eliminare cliente cancella anche tutti i pagamenti associati.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Gestione Insegnanti -->
            <section id="insegnanti" class="mb-5">
                <div class="card">
                    <div class="card-header bg-warning text-dark">
                        <h3 class="mb-0"><i class="bi bi-person-badge me-2"></i>Gestione Insegnanti</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Aggiungere Insegnante</h5>
                                <ol>
                                    <li><strong>Insegnanti</strong> ‚Üí <strong>Nuovo Insegnante</strong></li>
                                    <li>Compilare dati anagrafici</li>
                                    <li><strong>Cruciale:</strong> Impostare percentuale guadagno</li>
                                    <li><strong>Email obbligatoria</strong> per ricevere report automatici</li>
                                    <li>Inserire contatti e specializzazioni</li>
                                </ol>

                                <div class="alert alert-success mt-3">
                                    <h6><i class="bi bi-calculator me-2"></i>Esempio Calcolo</h6>
                                    <ul class="mb-0">
                                        <li>Corso incassa: ‚Ç¨1.000</li>
                                        <li>Insegnante al 30%: ‚Ç¨300</li>
                                        <li>Scuola trattiene: ‚Ç¨700</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>üìß Report Email Automatici</h5>
                                <p>Gli insegnanti con email ricevono automaticamente:</p>
                                <ul>
                                    <li><strong>Report compensi mensili</strong> con dettaglio per corso</li>
                                    <li><strong>Lista completa allievi</strong> per ogni corso</li>
                                    <li><strong>Status pagamenti</strong> per ogni allievo</li>
                                    <li><strong>Statistiche personalizzate</strong></li>
                                </ul>

                                <div class="alert alert-info">
                                    <h6><i class="bi bi-envelope me-2"></i>Invio Report</h6>
                                    <p class="mb-0">I report possono essere inviati da <strong>Report</strong> ‚Üí <strong>Email a Tutti</strong> o singolarmente per ogni insegnante.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Gestione Corsi -->
            <section id="corsi" class="mb-5">
                <div class="card">
                    <div class="card-header bg-info text-white">
                        <h3 class="mb-0"><i class="bi bi-calendar-week me-2"></i>Gestione Corsi</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Creare Nuovo Corso</h5>
                                <ol>
                                    <li><strong>Corsi</strong> ‚Üí <strong>Nuovo Corso</strong></li>
                                    <li>Nome corso descrittivo</li>
                                    <li>Selezionare giorno settimana</li>
                                    <li>Orario (formato 24h: 18:30)</li>
                                    <li>Prezzo mensile</li>
                                    <li>Assegnare insegnante</li>
                                </ol>
                            </div>
                            <div class="col-md-6">
                                <h5>Corsi con Orari Multipli</h5>
                                <p><strong>Per lo stesso tipo di danza in orari diversi, creare corsi separati:</strong></p>
                                
                                <div class="bg-light p-3 rounded">
                                    <ul class="mb-0">
                                        <li>"Danza Classica - Luned√¨ 18:00"</li>
                                        <li>"Danza Classica - Mercoled√¨ 19:00"</li>
                                        <li>"Danza Classica - Sabato 10:00"</li>
                                    </ul>
                                </div>
                                
                                <small class="text-muted mt-2 d-block">
                                    Ogni orario gestisce separatamente iscrizioni, pagamenti e compensi.
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Gestione Pagamenti -->
            <section id="pagamenti" class="mb-5">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h3 class="mb-0"><i class="bi bi-credit-card me-2"></i>Gestione Pagamenti</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Registrare Pagamento</h5>
                                <ol>
                                    <li><strong>Pagamenti</strong> dalla navbar</li>
                                    <li>Trovare pagamento "Non Pagato"</li>
                                    <li><strong>Segna come Pagato</strong></li>
                                    <li>Sistema aggiorna automaticamente</li>
                                </ol>

                                <h5 class="mt-4">üßæ Ricevute PDF con Logo</h5>
                                <ul>
                                    <li>Cliccare <strong>Ricevuta PDF</strong></li>
                                    <li>Include <strong>logo aziendale</strong> automaticamente</li>
                                    <li>Mostra Codice Fiscale cliente</li>
                                    <li>Numerazione progressiva</li>
                                    <li>Layout professionale</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5>Filtri Disponibili</h5>
                                <ul>
                                    <li><strong>Per periodo:</strong> Mese/Anno</li>
                                    <li><strong>Per stato:</strong> Pagati/Non pagati</li>
                                    <li><strong>Per cliente:</strong> Nome cognome</li>
                                    <li><strong>Per corso:</strong> Nome corso</li>
                                </ul>

                                <div class="alert alert-info mt-3">
                                    <i class="bi bi-lightbulb me-2"></i>
                                    <strong>Suggerimento:</strong> Usare i filtri per trovare rapidamente pagamenti scaduti o da riscuotere.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Report e Email -->
            <section id="report" class="mb-5">
                <div class="card">
                    <div class="card-header bg-dark text-white">
                        <h3 class="mb-0"><i class="bi bi-envelope-paper me-2"></i>Report Avanzati e Email</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <h5>üìä Report Generale</h5>
                                <ul>
                                    <li><strong>Incasso Totale:</strong> Tutti i pagamenti</li>
                                    <li><strong>Compensi Insegnanti:</strong> Da pagare</li>
                                    <li><strong>Utile Netto:</strong> Guadagno scuola</li>
                                    <li><strong>Numero Pagamenti:</strong> Quantit√†</li>
                                </ul>
                            </div>
                            <div class="col-md-4">
                                <h5>üéØ Report per Corso</h5>
                                <ul>
                                    <li>Incasso specifico corso</li>
                                    <li>Lista completa iscritti</li>
                                    <li>Status pagamenti per allievo</li>
                                    <li>Compenso insegnante</li>
                                    <li>Utile corso</li>
                                </ul>
                            </div>
                            <div class="col-md-4">
                                <h5>üë®‚Äçüè´ Report per Insegnante</h5>
                                <ul>
                                    <li>Lista corsi assegnati</li>
                                    <li>Allievi per ogni corso</li>
                                    <li>Incasso totale</li>
                                    <li>Percentuale media</li>
                                    <li>Compenso da ricevere</li>
                                </ul>
                            </div>
                        </div>

                        <hr>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <h5>üìß Sistema Email Automatico</h5>
                                <ol>
                                    <li><strong>Report</strong> ‚Üí Selezionare mese/anno</li>
                                    <li><strong>Email a Tutti</strong> per invio massivo</li>
                                    <li><strong>Icona Email</strong> per singolo insegnante</li>
                                </ol>

                                <div class="alert alert-success">
                                    <h6><i class="bi bi-magic me-2"></i>Email Professionale</h6>
                                    <ul class="mb-0">
                                        <li>Design HTML responsivo</li>
                                        <li>Logo aziendale embedded</li>
                                        <li>Dettaglio completo per corso</li>
                                        <li>Lista allievi con status pagamenti</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>üìã Esportazione</h5>
                                <ul>
                                    <li><strong>Stampa:</strong> Versione stampabile</li>
                                    <li><strong>Excel:</strong> Foglio di calcolo</li>
                                    <li><strong>PDF Compensi:</strong> Per insegnante</li>
                                    <li><strong>Email HTML:</strong> Report interattivi</li>
                                </ul>

                                <div class="alert alert-info">
                                    <h6><i class="bi bi-clock me-2"></i>Automazione</h6>
                                    <p class="mb-0">Gli insegnanti ricevono report dettagliati via email con un solo clic, inclusi tutti gli allievi e i relativi pagamenti.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Impostazioni & Logo -->
            <section id="impostazioni" class="mb-5">
                <div class="card">
                    <div class="card-header bg-secondary text-white">
                        <h3 class="mb-0"><i class="bi bi-image me-2"></i>Impostazioni Azienda & Logo</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>üè¢ Dati Aziendali</h5>
                                <ul>
                                    <li><strong>Denominazione Sociale:</strong> Nome ufficiale</li>
                                    <li>Indirizzo completo</li>
                                    <li>Partita IVA (11 cifre)</li>
                                    <li>Codice Fiscale (16 caratteri)</li>
                                    <li>Contatti (telefono, email, web)</li>
                                </ul>

                                <div class="alert alert-warning">
                                    <i class="bi bi-exclamation-triangle me-2"></i>
                                    <strong>Importante:</strong> Questi dati appaiono su tutte le ricevute e comunicazioni.
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>üé® Logo Aziendale</h5>
                                <ol>
                                    <li>Sezione <strong>"Logo Aziendale"</strong></li>
                                    <li>Cliccare <strong>"Carica Logo"</strong></li>
                                    <li>Scegliere file (JPG, PNG, GIF)</li>
                                    <li>Anteprima immediata</li>
                                </ol>

                                <div class="alert alert-success">
                                    <h6><i class="bi bi-eye me-2"></i>Il Logo Appare in:</h6>
                                    <ul class="mb-0">
                                        <li>üìß <strong>Tutte le email</strong> (report, 2FA, recovery)</li>
                                        <li>üîê <strong>Pagine di login</strong> e autenticazione</li>
                                        <li>üßæ <strong>Ricevute PDF</strong></li>
                                        <li>‚öôÔ∏è <strong>Anteprima impostazioni</strong></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Configurazione Email -->
            <section id="email-config" class="mb-5">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h3 class="mb-0"><i class="bi bi-envelope-gear me-2"></i>Configurazione Email SMTP</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>‚öôÔ∏è Setup SMTP</h5>
                                <ol>
                                    <li><strong>Impostazioni</strong> ‚Üí Sezione <strong>"Email SMTP"</strong></li>
                                    <li>Scegliere provider dal menu preimpostato:</li>
                                    <ul>
                                        <li>Gmail</li>
                                        <li>Outlook/Hotmail</li>
                                        <li>Yahoo</li>
                                        <li>Mailtrap (testing)</li>
                                        <li>SendGrid</li>
                                        <li>Altri provider personalizzati</li>
                                    </ul>
                                    <li>Inserire username e password</li>
                                    <li><strong>Test Email</strong> per verificare</li>
                                </ol>
                            </div>
                            <div class="col-md-6">
                                <h5>üìß Funzionalit√† Email</h5>
                                <p>Una volta configurato, il sistema invier√†:</p>
                                <ul>
                                    <li><strong>üîê Codici 2FA</strong> per login sicuro</li>
                                    <li><strong>üîë Link recupero password</strong> automatici</li>
                                    <li><strong>üìä Report compensi</strong> agli insegnanti</li>
                                </ul>

                                <div class="alert alert-info">
                                    <h6><i class="bi bi-toggle-on me-2"></i>Modalit√† Test</h6>
                                    <p class="mb-2">Attivare <strong>"Modalit√† Test"</strong> per:</p>
                                    <ul class="mb-0">
                                        <li>Testare configurazione senza invio reale</li>
                                        <li>Debug problemi SMTP</li>
                                        <li>Disattivare per inviare email reali</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Backup & Sicurezza -->
            <section id="backup" class="mb-5">
                <div class="card">
                    <div class="card-header bg-danger text-white">
                        <h3 class="mb-0"><i class="bi bi-shield-check me-2"></i>Backup e Sicurezza Avanzata</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>üíæ Backup Database</h5>
                                <ol>
                                    <li>Menu utente ‚Üí <strong>Backup Database</strong></li>
                                    <li>File scaricato: <code>backup_YYYYMMDD_HHMMSS.db</code></li>
                                    <li>Conservare in luogo sicuro</li>
                                </ol>

                                <h5 class="mt-4">üîÑ Ripristino</h5>
                                <ol>
                                    <li>Fermare l'applicazione</li>
                                    <li>Sostituire <code>data/database.db</code></li>
                                    <li>Riavviare applicazione</li>
                                </ol>
                            </div>
                            <div class="col-md-6">
                                <h5>üõ°Ô∏è Sicurezza Avanzata</h5>
                                <div class="alert alert-danger">
                                    <h6><i class="bi bi-shield-exclamation me-2"></i>Essenziale per Sicurezza:</h6>
                                    <ul class="mb-0">
                                        <li><strong>Cambiare password default</strong> admin/admin123</li>
                                        <li><strong>Attivare 2FA</strong> per account admin</li>
                                        <li><strong>Configurare email</strong> per recovery</li>
                                        <li><strong>Backup regolari</strong> (settimanali)</li>
                                        <li><strong>Non condividere</strong> credenziali</li>
                                    </ul>
                                </div>

                                <div class="alert alert-info">
                                    <h6><i class="bi bi-info-circle me-2"></i>Best Practice</h6>
                                    <ul class="mb-0">
                                        <li>Backup prima di aggiornamenti</li>
                                        <li>Password complesse per email SMTP</li>
                                        <li>Verifica periodica log accessi</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- FAQ Aggiornate -->
            <section id="faq" class="mb-5">
                <div class="card">
                    <div class="card-header bg-light">
                        <h3 class="mb-0"><i class="bi bi-question-circle me-2"></i>Domande Frequenti</h3>
                    </div>
                    <div class="card-body">
                        <div class="accordion" id="faqAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                        Come configurare l'email per 2FA e report?
                                    </button>
                                </h2>
                                <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        Vai in <strong>Impostazioni ‚Üí Email SMTP</strong>, scegli il provider (Gmail consigliato), inserisci le credenziali e testa l'invio. Per Gmail, usa una "password per le app" invece della password normale.
                                    </div>
                                </div>
                            </div>

                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                        Non ricevo i codici 2FA via email, cosa fare?
                                    </button>
                                </h2>
                                <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        1) Controlla la cartella spam, 2) Verifica configurazione SMTP in Impostazioni, 3) Disattiva "Modalit√† Test" se attiva, 4) Testa l'invio con il pulsante "Test Email".
                                    </div>
                                </div>
                            </div>

                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                        Come aggiungere il logo aziendale?
                                    </button>
                                </h2>
                                <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        <strong>Impostazioni ‚Üí Logo Aziendale ‚Üí Carica Logo</strong>. Formati supportati: JPG, PNG, GIF. Il logo apparir√† automaticamente in login, email e ricevute PDF.
                                    </div>
                                </div>
                            </div>

                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
                                        Gli insegnanti non ricevono i report via email?
                                    </button>
                                </h2>
                                <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        Verifica: 1) L'insegnante ha un indirizzo email configurato, 2) Email SMTP configurata correttamente, 3) "Modalit√† Test" disattivata, 4) Controlla spam dell'insegnante.
                                    </div>
                                </div>
                            </div>

                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq5">
                                        Il software funziona offline?
                                    </button>
                                </h2>
                                <div id="faq5" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        S√¨, completamente offline per gestione dati. Richiede connessione internet solo per: invio email, 2FA, recupero password. Tutti i dati sono salvati localmente.
                                    </div>
                                </div>
                            </div>

                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq6">
                                        Posso personalizzare i report email?
                                    </button>
                                </h2>
                                <div id="faq6" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        I report email includono automaticamente: logo aziendale, dati completi per corso, lista allievi, status pagamenti. Per personalizzazioni avanzate √® necessario modificare i template HTML in <code>templates/emails/</code>.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Footer Guida -->
            <div class="text-center text-muted mt-5 mb-4">
                <hr>
                <small>
                    <i class="bi bi-info-circle me-1"></i>
                    Dance2Manager v2.0 - Guida aggiornata con funzionalit√† Email & 2FA - {{ moment().strftime('%d/%m/%Y') if moment else '2024' }}
                </small>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Smooth scrolling per i link dell'indice
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});

// Evidenzia la sezione attiva nell'indice
window.addEventListener('scroll', function() {
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('.list-group-item[href^="#"]');
    
    let current = '';
    sections.forEach(section => {
        const sectionTop = section.getBoundingClientRect().top;
        if (sectionTop <= 100) {
            current = section.getAttribute('id');
        }
    });
    
    navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === '#' + current) {
            link.classList.add('active');
        }
    });
});

// Stili per la stampa
document.addEventListener('DOMContentLoaded', function() {
    const style = document.createElement('style');
    style.textContent = `
        @media print {
            .navbar, .btn, .sticky-top { display: none !important; }
            .col-md-3 { display: none !important; }
            .col-md-9 { flex: 0 0 100%; max-width: 100%; }
            .card { border: 1px solid #ddd; page-break-inside: avoid; }
            .card-header { background-color: #f8f9fa !important; color: #333 !important; }
            body { font-size: 12px; }
        }
    `;
    document.head.appendChild(style);
});
</script>
{% endblock %}